#!/usr/bin/env bash

BACKUP_FILE_NAME_CONTEXT=${1:-default}

BACKUP_FILE_NAME="$HOME/.homesick/repos/dotfiles/bash_it_config_$BACKUP_FILE_NAME_CONTEXT.sh"

echo "Backing up to file: $BACKUP_FILE_NAME"

# shellcheck disable=SC1090
source "$HOME/.bash_it/bash_it.sh"

echo "#!/usr/bin/env bash" > "$BACKUP_FILE_NAME"

{
  echo ""

  echo "# shellcheck disable=SC1090"
  # shellcheck disable=SC2016
  echo 'source "$HOME/.bash_it/bash_it.sh"'
  echo ""
  echo "bash-it disable alias      all"
  echo "bash-it disable completion all"
  echo "bash-it disable plugin     all"

  echo ""
  bash-it show alias      | grep "\\[x\\]" | awk '{print "bash-it enable alias "      $1}'

  echo ""
  bash-it show completion | grep "\\[x\\]" | awk '{print "bash-it enable completion " $1}'

  echo ""
  bash-it show plugin     | grep "\\[x\\]" | awk '{print "bash-it enable plugin "     $1}'
} >> "$BACKUP_FILE_NAME"

chmod +x "$BACKUP_FILE_NAME"
